import{a as F,u as I,r as E,j as e,H as T,L as N,B as o}from"./app-oKcMah4B.js";import{A as k}from"./AppLayout-BkjjBjrr.js";import{L as d,I as m}from"./input-pKAWPIMY.js";import{S as h,a as j,b as g,c as v,d as u}from"./select-IWh58R8R.js";import{D as A,T as y,B as $,S as M}from"./date-picker-B2wNXkp0.js";import{C as O,a as P,b as B,d as L,c as V}from"./card-C115FapS.js";import{A as U,a as H}from"./alert-uwR_on1N.js";import{A as z}from"./arrow-left-BCpD-NTc.js";import{C as p}from"./circle-alert-DnfFBuuy.js";import{F as b}from"./sun-BNKJhPB7.js";/* empty css            */import"./chevron-right-BSH8rqjn.js";import"./popover-B3yyS8N8.js";import"./calendar-CVHVOrJh.js";function ne({document:a,types:C,directions:S,availableRegistrations:_,errors:J}){const{toast:x}=F(),{data:s,setData:r,put:D,processing:l,errors:i}=I({registration_number:a.registration_number,direction:a.direction,document_type_id:a.type?.id?.toString()||"",document_type_text:a.document_type_text||"",page_count:a.page_count.toString(),title:a.title||"",notes:a.notes||"",user_identity:a.user_identity||"",issued_date:a.issued_date?new Date(a.issued_date):void 0,evidence:null});E.useEffect(()=>{i&&Object.keys(i).length>0&&Object.entries(i).forEach(([t,c])=>{x({variant:"destructive",title:"Validation Error",description:`${t}: ${c}`})})},[i]);const f=(t,c=!1)=>{t.preventDefault();const n=new FormData;n.append("registration_number",s.registration_number),n.append("direction",s.direction),n.append("page_count",s.page_count),n.append("is_draft",c.toString()),s.document_type_id&&n.append("document_type_id",s.document_type_id),s.document_type_text&&n.append("document_type_text",s.document_type_text),s.title&&n.append("title",s.title),s.notes&&n.append("notes",s.notes),s.user_identity&&n.append("user_identity",s.user_identity),s.issued_date&&n.append("issued_date",s.issued_date.toISOString().split("T")[0]),s.evidence&&n.append("evidence",s.evidence),D(`/documents/${a.id}`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{x({title:"Success",description:c?"Document saved as draft":"Document updated successfully"})},onError:()=>{x({variant:"destructive",title:"Error",description:`Failed to ${c?"save draft":"update document"}. Please check the form.`})}})},w=t=>{f(t,!0)};return e.jsxs(k,{children:[e.jsx(T,{title:`Edit Document ${a.registration_number}`}),e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(N,{href:`/documents/${a.id}`,children:e.jsxs(o,{variant:"ghost",size:"sm",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Edit Document"}),e.jsx("p",{className:"text-muted-foreground",children:"Update document information"})]})]}),e.jsxs(O,{children:[e.jsxs(P,{children:[e.jsx(B,{children:"Document Information"}),e.jsx(L,{children:"Update the details for this document"})]}),e.jsx(V,{children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"registration_number",children:["Registration Number ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(h,{value:s.registration_number,onValueChange:t=>r("registration_number",t),children:[e.jsx(j,{className:`w-full ${i.registration_number?"border-destructive":""}`,children:e.jsx(g,{placeholder:"Select registration number"})}),e.jsx(v,{children:_.length===0?e.jsx("div",{className:"p-2 text-sm text-muted-foreground",children:"No available registrations"}):_.map(t=>e.jsxs(u,{value:t.number,children:[t.number," (",t.state,")"]},t.id))})]}),i.registration_number&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),i.registration_number]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"direction",children:["Translation Direction ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(h,{value:s.direction,onValueChange:t=>r("direction",t),children:[e.jsx(j,{className:`w-full ${i.direction?"border-destructive":""}`,children:e.jsx(g,{placeholder:"Select direction"})}),e.jsx(v,{children:S.map(t=>e.jsx(u,{value:t,children:t==="Indo-Mandarin"?"Indonesian → Mandarin":t==="Mandarin-Indo"?"Mandarin → Indonesian":t==="Indo-Taiwan"?"Indonesian → Taiwanese":"Taiwanese → Indonesian"},t))})]}),i.direction&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),i.direction]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"document_type_id",children:"Document Type (Predefined)"}),e.jsxs(h,{value:s.document_type_id,onValueChange:t=>r("document_type_id",t),children:[e.jsx(j,{className:"w-full",children:e.jsx(g,{placeholder:"Select type"})}),e.jsxs(v,{children:[e.jsx(u,{value:"none",children:"None"}),C.map(t=>e.jsx(u,{value:t.id.toString(),children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"document_type_text",children:"Or Custom Type"}),e.jsx(m,{id:"document_type_text",value:s.document_type_text,onChange:t=>r("document_type_text",t.target.value),placeholder:"Enter custom type"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"title",children:"Document Title"}),e.jsx(m,{id:"title",value:s.title,onChange:t=>r("title",t.target.value),placeholder:"Enter document title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"page_count",children:["Page Count ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(m,{id:"page_count",type:"number",min:"1",value:s.page_count,onChange:t=>r("page_count",t.target.value),className:i.page_count?"border-destructive":""}),i.page_count&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),i.page_count]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"issued_date",children:"Issued Date"}),e.jsx(A,{value:s.issued_date,onChange:t=>r("issued_date",t),placeholder:"Pilih tanggal terbit dokumen"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"evidence",children:"Evidence File"}),e.jsx(m,{id:"evidence",type:"file",onChange:t=>r("evidence",t.target.files?.[0]||null),className:"cursor-pointer",accept:".pdf,.doc,.docx"}),s.evidence&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(b,{className:"h-4 w-4"}),s.evidence.name]}),a.evidence_path&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(b,{className:"h-4 w-4"}),"Current: ",a.evidence_path.split("/").pop()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accepted: PDF, DOC, DOCX (Max 20MB)"}),i.evidence&&e.jsxs("p",{className:"text-sm text-destructive flex items-center gap-1",children:[e.jsx(p,{className:"h-3 w-3"}),i.evidence]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"notes",children:"Notes"}),e.jsx(y,{id:"notes",value:s.notes,onChange:t=>r("notes",t.target.value),placeholder:"Add any additional notes or comments...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"user_identity",children:"Identitas Pengguna Jasa"}),e.jsx(y,{id:"user_identity",value:s.user_identity,onChange:t=>r("user_identity",t.target.value),placeholder:"Masukkan identitas pengguna jasa (nama, alamat, dll)...",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Informasi identitas lengkap pengguna jasa yang meminta terjemahan"})]}),e.jsx(U,{children:e.jsx(H,{children:"You can save as draft to continue later, or submit the document for processing."})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(N,{href:`/documents/${a.id}`,className:"flex-1",children:e.jsx(o,{type:"button",variant:"outline",className:"w-full bg-transparent",children:"Cancel"})}),e.jsxs(o,{type:"button",variant:"secondary",onClick:w,disabled:l,className:"flex-1",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),l?"Saving...":"Save as Draft"]}),e.jsxs(o,{type:"submit",disabled:l,className:"flex-1",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),l?"Updating...":"Update Document"]})]})]})})]})]})]})}export{ne as default};
